---
title: "hy2912_p8105_hw3"
author: "Helen Yousaf"
date: "2024-10-07"
output: github_document
---
```{r}
library(readr)
library(tidyverse)
library(ggridges)
```

# Problem 2 
#### MIMS Data

Importing MIMS Demographic data
```{r}
MIMS_dg_df = 
  read_csv(file = "/Users/helenyousaf/Desktop/hy2912_p8105_hw3/MIMS.dg.csv", 
           skip = 4, na = c(".", "NA", ""), 
    col_types = cols(
      'SEQN' = col_character(),
      `sex` = col_character(),
      `age` = col_integer(),
      `BMI` = col_double(),
      `education` = col_character(),
    )
  )
```

```{r}
names(MIMS_dg_df)
MIMS_dg_df = janitor::clean_names(MIMS_dg_df)
```

Importing MIMS Accelerometer data 
```{r}
MIMS_ac_df = 
  read_csv(file = "/Users/helenyousaf/Desktop/hy2912_p8105_hw3/MIMS.ac.csv", 
           na = c(".", "NA", ""), 
     col_types = cols(
      'SEQN' = col_character(),
    )
  )       
```

```{r}
names(MIMS_ac_df)
MIMS_ac_df = janitor::clean_names(MIMS_ac_df)
```

Joining data sets to form MIMS_comb_df
```{r}
MIMS_comb_df = 
  left_join (MIMS_dg_df, MIMS_ac_df, by = "seqn") 
```

```{r}
MIMS_comb_df = 
  drop_na(MIMS_comb_df) |>
  filter ("age" >= 21) |>
  mutate(across(c(sex, education), as.factor)
)
```

Gender and Education Summary Table 
```{r}
gender_ed_df <- MIMS_comb_df |>
  group_by(education, sex) |>
  summarise(count = n()) |>
  pivot_wider(names_from = sex, values_from = count, values_fill = 0)
```

```{r}
gender_ed_df
```
Visualization of the Age-Sex Distribution by Education Level
```{r}
ggplot(MIMS_comb_df, aes(x = age, fill = sex)) +
  geom_histogram(position = "dodge", binwidth = 10, alpha = 0.5) +
  facet_wrap(~ education) +
  labs(title = "Age-Sex Distribution By Education Level",
       x = "Age (years)",
       y = "Count") +
  theme_minimal()
```
Total activity dataset 
```{r}
total_activity_df <- MIMS_comb_df |>
  group_by(seqn, age, sex, education) |>
  summarise(total_activity = sum(min1:min1440, na.rm = TRUE)) 
```
```{r}
total_activity_df
```
Plot of total activities against age, by sex and education
```{r}
ggplot(total_activity_df, aes(x = age, y = total_activity, color = sex)) +
  geom_point() +
  geom_smooth(method = "loess") +
  facet_wrap(~ education) +
  labs(x = "Age", y = "Total Activity", title = "Total Activity Against Age, by Gender and Education Level") +
  theme_minimal()
```
24-hour activity by education data set
```{r}
total_activity_df |>
  select(education, total_activity) |> 
  ggplot(aes(x = total_activity, fill = total_activity, color =sex)) 
  geom_density(alpha = .5) + 
  facet_grid(~education) + 
  viridis::scale_fill_viridis(discrete = TRUE)
```
# Problem 3
#### Citi Bike Data 

Loading data sets 
```{r}
Jan2020_df = read_csv(file = "/Users/helenyousaf/Desktop/hy2912_p8105_hw3/Jan2020.CITI.csv", na = c(".", "NA", ""))
Jul2020_df = read_csv(file = "/Users/helenyousaf/Desktop/hy2912_p8105_hw3/July2020.CITI.csv", na = c(".", "NA", ""))
Jan2024_df = read_csv(file = "/Users/helenyousaf/Desktop/hy2912_p8105_hw3/Jan2024.CITI.csv", na = c(".", "NA", ""))
Jul2024_df = read_csv(file = "/Users/helenyousaf/Desktop/hy2912_p8105_hw3/July2024.CITI.csv", na = c(".", "NA", ""))
```

Basic cleaning of data sets
```{r}
Jan2020_df = 
  janitor::clean_names (Jan2020_df)
```
```{r}
Jan2020_df = drop_na(Jan2020_df)
```
```{r}
Jul2020_df = janitor::clean_names (Jul2020_df)
```
```{r}
Jul2020_df = drop_na(Jul2020_df)
```
```{r}
Jan2024_df = janitor::clean_names (Jan2024_df)
```
```{r}
Jan2024_df = drop_na(Jan2024_df)
```
```{r}
Jul2024_df = janitor::clean_names (Jul2024_df)
```
```{r}
Jul2024_df = drop_na(Jul2024_df)
```



```{r}
Jan2020_df = 
  col_types = cols(
      member_casual = col_character() 
  )
```
